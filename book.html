<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Book Details</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header>
    <h1 data-i18n="title">üìö Bookoria Library</h1>
    <nav>
      <a href="index.html" class="nav-link" data-i18n="nav_main">Home</a> |
      <a href="books.html" class="nav-link" data-i18n="nav_books">Books</a> |
      <a href="about.html" class="nav-link" data-i18n="nav_about">About</a> |
      <a href="contact.html" class="nav-link" data-i18n="nav_contact">Contact</a>
      <button id="lang-toggle" class="lang-button">English</button>
      <span id="auth-links" style="float: right; margin-left: 20px;"></span>
    </nav>
  </header>


  <main class="container">
    <div id="bookDetail" class="book-detail"></div>
  </main>

  <script>
  const params = new URLSearchParams(window.location.search);
  const bookId = params.get("id");
  const lang = localStorage.getItem("lang") || "en";

  fetch("books.json")
    .then(res => res.json())
    .then(data => {
      const book = data.find(b => b.id.toString() === bookId);
      if (!book) {
        document.getElementById("bookDetail").innerHTML = "<p>Book not found.</p>";
        return;
      }

      document.getElementById("bookDetail").innerHTML = `
        <img src="${book.cover}" alt="${book.title[lang]}" class="detail-cover"/>
        <div class="detail-info">
          <h2>${book.title[lang]}</h2>
          <p><strong>Author:</strong> ${book.author[lang]}</p>
          <p><strong>Description:</strong> ${book.description[lang]}</p>
          <p><strong>Book Language:</strong> ${book.bookLanguage[lang]}</p>
          <button id="borrowBtn">Borrow this book</button>
          <button id="favBtn">‚ù§Ô∏è Save to Favorites</button>
          <a href="books.html" class="back-button">‚Üê Back to list</a>
        </div>
      `;

      document.getElementById('borrowBtn').addEventListener('click', () => {
        const currentUser = JSON.parse(localStorage.getItem('loggedInUser'));
        if (!currentUser) {
          alert("Please log in to borrow books.");
          window.location.href = 'login.html';
          return;
        }

        const borrowedBooks = JSON.parse(localStorage.getItem('borrowedBooks')) || [];
        borrowedBooks.push({ user: currentUser.username, bookId: book.id, title: book.title[lang] });
        localStorage.setItem('borrowedBooks', JSON.stringify(borrowedBooks));
        alert(`You borrowed "${book.title[lang]}"`);
      });

      document.getElementById('favBtn').addEventListener('click', () => {
        const currentUser = JSON.parse(localStorage.getItem('loggedInUser'));
        if (!currentUser) {
          alert("Please log in to favorite books.");
          return;
        }

        const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        favorites.push({ user: currentUser.username, bookId: book.id });
        localStorage.setItem('favorites', JSON.stringify(favorites));
        alert("Added to favorites!");
      });
    });
</script>
  
  <script>
  const translations = {
    en: {
      title: "üìö Bookoria Library",
      nav_books: "Books",
      nav_main: "Home",
      nav_about: "About",
      nav_contact: "Contact",
    },
    id: {
      title: "üìö Perpustakaan Bookoria",
      nav_books: "Buku",
      nav_main: "Beranda",
      nav_about: "Tentang",
      nav_contact: "Kontak",
    }
  };

  let currentLang = "en";

  function updateLanguage(lang) {
    document.querySelectorAll("[data-i18n]").forEach(el => {
      const key = el.getAttribute("data-i18n");
      el.textContent = translations[lang][key];
    });

    document.getElementById("lang-toggle").textContent = lang === "en" ? "Bahasa Indonesia" : "English";
    currentLang = lang;
  }

  document.getElementById("lang-toggle").addEventListener("click", () => {
  const newLang = currentLang === "en" ? "id" : "en";
  localStorage.setItem("lang", newLang);
  location.reload();
});

  // Initial language setup
  updateLanguage(currentLang);
</script>

<script>
  // Example function triggered by the language switch button
function toggleLanguage() {
  const currentLang = localStorage.getItem("lang") || "en";
  const newLang = currentLang === "en" ? "id" : "en";
  localStorage.setItem("lang", newLang);
  location.reload(); // Reload to update content
}
</script>

<script>
  document.addEventListener("DOMContentLoaded", async () => {
  const urlParams = new URLSearchParams(window.location.search);
  const bookId = parseInt(urlParams.get("id"));
  const lang = localStorage.getItem("lang") || "en";

  const res = await fetch("books.json");
  const books = await res.json();
  const book = books.find(b => b.id === bookId);

  if (book) {
    document.getElementById("book-title").textContent = book.title[lang];
    document.getElementById("book-author").textContent = book.author[lang];
    document.getElementById("book-description").textContent = book.description[lang];
    document.getElementById("book-cover").src = book.cover;
  }
});
</script>

  <script src="js/script.js"></script>
</body>
</html>